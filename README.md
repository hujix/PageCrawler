# PageExtractor: é¡µé¢æå–æœåŠ¡

## æ¦‚è¿°

`PageExtractor`æ—¨åœ¨æä¾›é«˜æ•ˆçš„é¡µé¢æå–æœåŠ¡ã€‚é€šè¿‡è¾“å…¥URLï¼Œå¯ä»¥è·å¾—ç½‘é¡µçš„å…³é”®å†…å®¹ã€‚

é€šè¿‡ä½¿ç”¨`aiohttp`ã€`playwright`ã€`puppeteer`ä¸‰ç§æ–¹å¼è¿›è¡Œé¡µé¢å†…å®¹çš„è·å–ã€‚

## å®‰è£…è¿è¡Œ

å®‰è£…ä¾èµ–

```shell
pip install -r requirements.txt
```

è¿è¡Œé¡¹ç›®

```shell
uvicorn main:app --host 0.0.0.0 --port 8899
```

> **å…³äº --reload**
>
> ç”±äºæŸç§ä¸å¯æŠ—åŠ›çš„å½±å“ï¼Œå½“ä½¿ç”¨å‘½ä»¤
>
> `uvicorn main:app --host 0.0.0.0 --port 8899 --reload`
>
> è¿è¡Œé¡¹ç›®æ—¶ï¼Œ`playwright`çš„è¿è¡Œä¼šå‡ºç°å¼‚å¸¸ï¼š`raise NotImplementedError`

## è¯·æ±‚è°ƒç”¨

```shell
curl --location 'http://localhost:8899/extract' \
--header 'Content-Type: application/json' \
--data '{
    "url": "https://wap.peopleapp.com/article/7318277/7155177",
    "adapters": [
        "playwright"
    ]
}'
```

å‚æ•°`adapters`é»˜è®¤ä¸º`['request']`ï¼Œå³ä½¿ç”¨`aiohttp`è¿›è¡Œç›´æ¥çš„è¯·æ±‚ã€‚ å½“ä¼ å…¥å¤šä¸ª`adapter`æ—¶ï¼Œæˆ–é€‰æ‹©ä¸€ä¸ªå†…å®¹æœ€é•¿çš„ç»“æœè¿›è¡Œè¿”å›ã€‚

`adapter`çš„å¯é€‰å‚æ•°ä¸ºï¼š`request`ã€`playwright`ã€`puppeteer`ã€‚

## é¡¹ç›®ç»“æ„

```text
PageExtractor
â”‚  .gitignore
â”‚  LICENSE
â”‚  logger.py
â”‚  main.py
â”‚  models.py
â”‚  README.md
â”‚  requirements.txt
â”‚          
â”œâ”€crawler                           # çˆ¬è™«æ¨¡å—
â”‚  â”‚  abstract_crawler_adapter.py   # çˆ¬è™«é€‚é…å™¨æŠ½è±¡æ¨¡å— 
â”‚  â”‚  models.py
â”‚  â”‚  page_crawler.py               # çˆ¬è™«é€‚é…å™¨åˆå§‹åŒ–ä»¥åŠç¼–æ’è°ƒç”¨
â”‚  â”‚  utils.py
â”‚  â”‚  __init__.py
â”‚  â”‚  
â”‚  â”œâ”€adapter                        # å…·ä½“çš„çˆ¬è™«é€‚é…å™¨æ¨¡å—
â”‚  â”‚  â”‚  playwright_adapter.py
â”‚  â”‚  â”‚  puppeteer_adapter.py
â”‚  â”‚  â”‚  request_adapter.py
â””â”€â”€â””â”€â”€â””â”€  __init__.py
```

## å…³äºäºŒåˆ›

å¦‚è‹¥æ²¡æœ‰ç‰¹æ®Šçš„ã€æ˜ç¡®çš„éœ€æ±‚ï¼Œåªéœ€è¦å¯¹`crawler/page_crawler.py`ä¸­çš„`crawl_page`æ–¹æ³•è¿›è¡Œä¿®æ”¹æˆ–æ‹“å±•ã€‚

åœ¨è¿™é‡Œå¯ä»¥å®ç°å¯¹ä¸åŒç±»å‹çš„çˆ¬è™«è¿›è¡Œç¼–æ’ä¸è°ƒç”¨ã€‚

å¯¹äºä½¿ç”¨`aiohttp`çš„ç›´æ¥è¯·æ±‚ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨ä¸¤ç§æµè§ˆå™¨çš„æ¸²æŸ“æ–¹å¼ï¼Œä½œè€…ä»¥åŠç»è¿‡äº†å¤§é‡çš„`URL`è¿›è¡Œæµ‹è¯•ï¼Œç›®å‰ç®—æ˜¯ç¡®å®šäº†åœ¨å¤§å¤šæ•°çš„æƒ…å†µä¸‹ï¼Œé€Ÿåº¦è¾¾åˆ°äº†æœ€ä¼˜ã€‚

## Q&A

### Q: ä¸ºä»€ä¹ˆé€‰æ‹©ä¸¤ç§æµè§ˆå™¨æ¸²æŸ“æ¡†æ¶ï¼Ÿ

åœ¨ä¸€äº›å¸¸ç”¨ç½‘é¡µçš„æ¸²æŸ“ä¸‹ï¼Œ`playwright`çš„å¹³å‡é€Ÿåº¦æ˜æ˜¾æ¯”`puppeteer`çš„é€Ÿåº¦è¦å¥½çš„å¤šï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œåœ¨ç½‘ç»œå±‚é¢ï¼Œ`playwright`
æ²¡æœ‰`puppeteer`å¯¹é¡µé¢æ¸²æŸ“è¿”å›æ§åˆ¶çš„ç²’åº¦ç»†ï¼š

| ç²’åº¦               | æè¿°                       | playwright | puppeteer |
|------------------|--------------------------|:----------:|:---------:|
| commit           | åœ¨æ”¶åˆ°ç½‘ç»œå“åº”å¹¶å¼€å§‹åŠ è½½æ–‡æ¡£æ—¶ã€‚         |     âœ…      |     âŒ     |
| domcontentloaded | è§¦å‘â€œDOMContentLoadedâ€äº‹ä»¶æ—¶ã€‚ |     âœ…      |     âœ…     |
| load             | è§¦å‘â€œloadâ€äº‹ä»¶æ—¶              |     âœ…      |     âœ…     |
| networkidle      | å½“è‡³å°‘â€œ500â€æ¯«ç§’æ²¡æœ‰ç½‘ç»œè¿æ¥æ—¶ã€‚       |     âœ…      |     âŒ     |
| networkidle0     | å½“è‡³å°‘ 500 æ¯«ç§’çš„ç½‘ç»œè¿æ¥ä¸è¶…è¿‡ 0 æ—¶ã€‚  |     âŒ      |     âœ…     |
| networkidle2     | å½“è‡³å°‘ 500 æ¯«ç§’çš„ç½‘ç»œè¿æ¥ä¸è¶…è¿‡ 2 ä¸ªæ—¶ã€‚ |     âŒ      |     âœ…     |

åœ¨é¡µé¢æ¸²æŸ“æ—¶`playwright`èƒ½å¤Ÿè·å–ç»å¤§éƒ¨åˆ†çš„é¡µé¢å†…å®¹ï¼Œä½†æ˜¯è·å–ä¸åˆ°é¡µé¢éœ€è¦å‘é€å¦‚`http`
è¯·æ±‚çš„ç½‘ç«™ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´ï¼Œè·å–åˆ°çš„åªæ˜¯ä¸€ä¸ªç©ºå†…å®¹çš„`html`çš„ç»“æ„ã€‚

è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨`puppeteer`æ¥è¿›è¡Œæ¸²æŸ“ï¼Œä½¿ç”¨`networkidle2`çš„æ§åˆ¶ç²’åº¦ï¼Œå¯ä»¥å¾ˆå¥½çš„è·å–åˆ°è¿™ç±»çš„ç½‘ç«™ã€‚

## ğŸ‰ ç¥å¥½è¿~

<div align="center">
 <img src="https://www.emojiall.com/en/header-svg/%F0%9F%8E%89.svg" width="300" alt="ğŸ‰">
</div>

